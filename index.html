<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard - Consultas & Gupshup</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #0f172a;
        color: #e5e7eb;
        padding: 20px;
    }

    h1, h2 {
        margin-bottom: 10px;
    }

    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 16px;
        margin-bottom: 30px;
    }

    .card {
        background: #020617;
        padding: 16px;
        border-radius: 8px;
        border: 1px solid #1e293b;
    }

    .card h3 {
        margin: 0;
        font-size: 14px;
        color: #94a3b8;
    }

    .card p {
        font-size: 28px;
        margin: 8px 0 0;
        font-weight: bold;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        background: #020617;
        margin-top: 10px;
    }

    th, td {
        padding: 10px;
        border-bottom: 1px solid #1e293b;
        text-align: left;
    }

    th {
        color: #94a3b8;
        font-size: 13px;
    }

    .GREEN { color: #22c55e; font-weight: bold; }
    .YELLOW { color: #eab308; font-weight: bold; }
    .RED { color: #ef4444; font-weight: bold; }
    .fullscreen-btn {
    position: fixed;
    top: 16px;
    right: 16px;
    background: #020617;
    color: #e5e7eb;
    border: 1px solid #1e293b;
    padding: 10px 14px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    z-index: 9999;
    }

    .fullscreen-btn:hover {
        background: #020617;
        border-color: #334155;
    }
</style>
</head>

<body>
<button class="fullscreen-btn" onclick="toggleFullscreen()">
    â›¶ Tela cheia
</button>
<h1>ðŸ“Š Dashboard Operacional</h1>

<!-- ================= GUPSHUP ================= -->
<h2>SaÃºde dos NÃºmeros (Gupshup)</h2>

<table>
    <thead>
        <tr>
            <th>Nome</th>
            <th>Telefone</th>
            <th>Qualidade</th>
            <th>Tier</th>
        </tr>
    </thead>
    <tbody id="gupshup-table">
        <tr>
            <td colspan="4">Carregando...</td>
        </tr>
    </tbody>
</table>

<script>
/* ================= CONFIG ================= */
const API_BASE_URL = "189.79.55.135:8922";
const API_KEY = "081peqsjqtbwwhivzuvjejax5obasd7v";

/* ================= CONSULTAS STATUS ================= */

function toggleFullscreen() {
    if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
            console.error("Erro ao entrar em fullscreen:", err);
        });
    } else {
        document.exitFullscreen();
    }
}
/* ================= GUPSHUP ================= */
async function carregarGupshup() {
    const tbody = document.getElementById("gupshup-table");

    try {
        const res = await fetch(`${API_BASE_URL}/webhook/gupshup/waba-health`, {
            headers: { apikey: API_KEY }
        });

        const result = await res.json();
        tbody.innerHTML = "";

        result.data.forEach(item => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
                <td>${item.name}</td>
                <td>${item.phone}</td>
                <td class="${item.phoneQuality}">
                    ${item.phoneQuality}
                </td>
                <td>${item.messagingLimit}</td>
            `;
            tbody.appendChild(tr);
        });

    } catch (e) {
        tbody.innerHTML = `
            <tr>
                <td colspan="4">Erro ao carregar dados</td>
            </tr>
        `;
        console.error(e);
    }
}

/* ================= INIT ================= */
carregarGupshup();

/* ðŸ”„ AUTO REFRESH (1 minuto) */
setInterval(() => {
    carregarGupshup();
}, 60000);
</script>

</body>
</html>
